function btnSelectPoint(d,f){$("#inpostModalMap").modal("hide");setTimeout(function(){$("#inpostModalMap").after('<div class="radio"><label><input type="radio" name="shipping_method" value="inpost.inpost_'+d+'" checked="checked">'+d+" - "+f+"</label></div>");$.ajax({url:"/index.php?route=extension/shipping/inpost/inpost/setData",type:"POST",data:{id:d},error:function(a){a.responseText&&console.error(a.responseText)},success:function(a){console.log(a)}})},1E3)}
$(document).ajaxComplete(function(){function d(){if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(c){a(c.coords.latitude,c.coords.longitude,14)},function(c){if(c.code==c.PERMISSION_DENIED){console.log("nie ma");var b=document.getElementById("inpost-google-map");c=b.getAttribute("data-lat");var g=b.getAttribute("data-lng"),b=b.getAttribute("data-zoom");a(c,g,b);console.error("Geolocation is not supported by this browser.")}});else{var b=document.getElementById("inpost-google-map"),
g=b.getAttribute("data-lat"),e=b.getAttribute("data-lng"),b=b.getAttribute("data-zoom");a(g,e,b);console.error("Geolocation is not supported by this browser.")}}function f(b,a){var e=$.Deferred();console.log(b,a);$.getJSON("/index.php?route=extension/shipping/inpost/inpost/index",{postcode:b,id:a}).done(function(b){e.resolve({data:b.data})});return e}function a(b,a,e){document.getElementById("inpost-google-map").getAttribute("data-content");b={scrollwheel:!1,navigationControl:!0,mapTypeControl:!1,
scaleControl:!0,draggable:!0,zoomControl:!0,zoom:parseInt(e),center:new google.maps.LatLng(b,a),mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("inpost-google-map"),b);var c,d=new google.maps.InfoWindow;f(null,null,null).done(function(b){console.log(b);$.each(b.data,function(b,a){c=new google.maps.Marker({map:map,position:new google.maps.LatLng(a.lat,a.lng)});google.maps.event.clearListeners(c,"idle");google.maps.event.addListener(c,"click",function(b,a,c){return function(){$("#inpost-google-map");
c.setContent('<div class="iw-map-container text-left"><p class="text-left"><b>'+a.description+"</b><br/>"+a.street+"<br/>"+a.postcode+" "+a.city+'</p></div><button type="button" onclick="btnSelectPoint(\''+a.id+"', '"+a.street+", "+a.city+'\');" class="btn btn-default btn-sm"><i class="fa fa-check"></i> wybierz ten paczkomat</button>');c.open(map,b)}}(c,a,d))})});$("#btnInpostFindByForm").on("click",function(){var b=$("#inpost-postcode").val(),a=$("#inpost-id").val();f(b,a).done(function(b){console.log(b.data[0].lat);
var a={scrollwheel:!1,navigationControl:!0,mapTypeControl:!1,scaleControl:!0,draggable:!0,zoomControl:!0,zoom:14,center:new google.maps.LatLng(b.data[0].lat,b.data[0].lng),mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("inpost-google-map"),a);var c,d=new google.maps.InfoWindow;$.each(b.data,function(b,a){c=new google.maps.Marker({map:map,position:new google.maps.LatLng(a.lat,a.lng)});google.maps.event.clearListeners(c,"idle");google.maps.event.addListener(c,
"click",function(b,a,c){return function(){$("#inpost-google-map");c.setContent('<div class="iw-map-container text-left"><p class="text-left"><b>'+a.description+"</b><br/>"+a.street+"<br/>"+a.postcode+" "+a.city+'</p></div><button type="button" onclick="btnSelectPoint(\''+a.id+"', '"+a.street+", "+a.city+'\');" class="btn btn-default btn-sm"><i class="fa fa-check"></i> wybierz ten paczkomat</button>');c.open(map,b)}}(c,a,d))})})})}$("#inpostModalMap").on("shown.bs.modal",function(){console.log("Otwarto okno, \u0142adowanie mapy google");
d()})});
